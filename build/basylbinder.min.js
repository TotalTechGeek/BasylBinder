/*! 
 * BasylBinder
 * 
 * Copyright 2018, Jesse Daniel Mitchell
 * Released under the MIT license.
 *
 * Date: 2018-04-22T22:35:32.502Z
 */
if("undefined"==typeof window.$$)$$=function(a){return a instanceof Event?$$.from(a.target):a instanceof HTMLElement||"object"==typeof a?$$.from(a):void 0};else{var z=window.$$;$$=function(a,b){return a instanceof Event?$$.from(a.target):a instanceof HTMLElement||"object"==typeof a?$$.from(a):z(a,b)}}function createBasylBinder(b){function c(a){let b=[];for(let c=0;c<a.length;c++)b.push(a[c]);return b}function a(a){var b=document.createElement("template");return a=a.trim(),b.innerHTML=a,b.content.firstChild}function d(a,c){a.value=c(a.value);let d=a.onchange||H;return a.onchange=(b)=>{b.target.value=c(b.target.value),d(b),a.oninput&&a.oninput(b)},b}function e(a,c,d,e){let f=b.bindings[a][0]().count(),g=()=>b.bindings[a][0]().get(f),h=(c)=>{b.bindings[a][0]().set(c,f),b.update(a)};if("undefined"!=typeof c.attributes["bind-index"])f=c.getAttribute("bind-index"),"undefined"==typeof g()&&h("");else{for(;"undefined"!=typeof g();)f++;c.setAttribute("bind-index",f),h("")}if(!e){let e=function(){if(c[d]=g(),!c.parentNode){let c=b.bindings[a][2].indexOf(e);b.bindings[a][2].splice(c,1)}};b.bindings[a][2].push(e),c[d]=g()}i(a,c,d,g,h)}function f(a,c,d,e){e||(b.bindings[a][2].push([c,d]),c[d]=b.bindings[a][0]()),i(a,c,d,()=>b.get(a),(c)=>b.set(a,c))}function g(a,c,d,e,f,g){if("undefined"==typeof b.bindings[c])return void delete d.oninput;if(f()!=a.target[e])if((d instanceof HTMLTextAreaElement||d instanceof HTMLInputElement)&&-1!==["text","url","password","telephone","search",""].indexOf((d.getAttribute("type")||"").toLowerCase().trim())){let b=d.selectionStart,c=d.selectionEnd;g(a.target[e]),d.setSelectionRange(b,c)}else g(a.target[e])}function h(a,c,d,e,f,g){return"undefined"==typeof b.bindings[c]?void delete d.oninput:void(f()!=a.target[e]&&(d.hasAttribute("on-true")&&!0==a.target[e]?g(d.getAttribute("on-true")):d.hasAttribute("on-false")&&!1==a.target[e]?g(d.getAttribute("on-false")):g(a.target[e])))}function i(a,b,c,d,f){(b instanceof HTMLInputElement||b instanceof HTMLTextAreaElement||b.hasAttribute("contenteditable")||b instanceof HTMLSelectElement)&&(b.attributes.type&&("checkbox"===b.getAttribute("type")||"file"===b.getAttribute("type"))||b instanceof HTMLSelectElement?b.onchange=(g)=>h(g,a,b,c,d,f):b.oninput=(h)=>g(h,a,b,c,d,f))}function j(a,c,d,g){return g="undefined"!=typeof g&&g,a=k(c,a),"undefined"!=typeof b.bindings[a]&&"undefined"!=typeof c&&(4==b.bindings[a].length&&"Array"==b.bindings[a][3]?e(a,c,d,g):f(a,c,d,g)),b}function k(a,c){c=c.toLowerCase();let d;return(d=b.closest(a,c))?d.getAttribute(B).toLowerCase()+":"+c:"undefined"==typeof b.bindings[c]?null:c}function l(){return Math.random().toString(36).substring(2)}function m(a){let b={};return b.bind=function(c,d){return j(c,a,"value",d),b},b.format=function(c){return d(a,c),b},b}function n(a){let b=new DOMParser().parseFromString(a,"text/html");return b.documentElement.textContent}function o(a){let b={};return b.bind=function(c,d,e){return j(c,a,d,e),b},b}function p(a){b.from("*"+a+"["+B+"]").for((a)=>{""===a.getAttribute(B)&&a.setAttribute(B,l())})}function q(a){b.from("*"+a+"basyl-style,script[type=\"basyl-style\"]").for((c)=>{let d=document.createElement("style");d.innerHTML=c.innerHTML,c.parentNode.replaceChild(d,c),b.from(d).watch("-html")})}function r(a){function c(c,d){b.from("*"+a+c).for((a)=>{b.from(a.attributes).for((c)=>b.from(a)[d](c.name,c.value)),a.parentNode.removeChild(a)})}return p(a),c(C,"var"),c(G,"const"),c(E,"dvar"),b.from("*"+a+F).for((a)=>{b.from(a.attributes).for((a)=>b.pvar(a.name,a.value)),a.parentNode.removeChild(a)}),b}function s(a){b.from("*"+a+"component[make]").for((a)=>{b.components[a.getAttribute("type")]=[a.innerHTML],a.parentNode.removeChild(a)})}function t(a){b.from("*"+a+"component[from]").for((a)=>{let c=a.getAttribute("type");a.setAttribute("was-from",!0),a.removeAttribute("from"),a.setAttribute("watch","html");let d=a.querySelectorAll(C+","+G);a.innerHTML=b.components[c][0],b.from(d).for((b)=>a.appendChild(b)),d.length&&a.setAttribute("local-bind","")})}function u(a){return"undefined"==typeof a?"":a+" "}function v(a){b.from("*"+a+"[basyl-if]:not(basyl-if-watched)").for((a)=>{let c,d=a.getAttribute("basyl-if"),e=(a)=>a;-1!=(c=d.indexOf("|"))&&(e=new Function(d.substring(0,c),"return "+d.substring(c+1)),d=d.substring(0,c));let f=a.style.display;d=k(a,d),b.bind(d,()=>{a.style.display=e(b.get(d))?f:"none"}),a.style.display=e(b.get(d))?f:"none",a.setAttribute("basyl-if-watched",d),a.removeAttribute("basyl-if")})}function w(a){b.from("*"+a+D).for((a)=>{new Function("me",a.textContent)(a),a.parentNode.removeChild(a)})}function x(a){b.from("*"+a+"[watch]:not([watched])").for((a)=>{let c=a.getAttribute("watch").split(" ");b.from(c).for((c)=>{b.from(a).watch(c)}),a.setAttribute("watched",a.getAttribute("watch").toLowerCase()),a.removeAttribute("watch")})}function y(a,c){c="undefined"==typeof c?0:c,b.from("*"+a+"[bind]:not([bound])").for((d)=>{let e=k(d,d.getAttribute("bind"));if("undefined"==typeof b.bindings[e])return c++,void(4>c&&setTimeout(()=>y(a,c),200*c));let f,g="undefined"!=typeof d.attributes["one-way"];f="undefined"==typeof d.attributes["bind-to"]?d instanceof HTMLInputElement?"object"==typeof d.attributes.type&&"checkbox"===d.getAttribute("type")?"checked":"value":d instanceof HTMLTextAreaElement||d instanceof HTMLSelectElement?"value":"textContent":d.getAttribute("bind-to"),d.setAttribute("bound",e),d.removeAttribute("bind"),j(e,d,f,g)})}b.bindings={},b.components={};let z={},A={};const B="local-bind",C="vars",D="script[type=\"basyl-script\"]",E="dvars",F="pvars",G="svars";b.queueUpdate=function(a,c){"undefined"!=typeof A[a]&&clearTimeout(A[a]),A[a]=setTimeout(()=>{b.update(a),delete A[a]},c)},b.make=function(c,d){let e="";return d&&(e="<vars ",Object.keys(d).forEach((a)=>{e+=a.replace(/ /g,"")+"=\""+d[a]+"\""}),e+="></vars>"),{appendTo:(d)=>{let f=a(`<component type="${c}" from>`+e+`</component>`);return d.setAttribute("basyl-now",""),d.appendChild(f),b.all("[basyl-now]"),d.removeAttribute("basyl-now"),b.from(f)}}},b.bind=function(a,c){return r(" "),a=a.toLowerCase(),"string"==typeof c&&(c=c.toLowerCase()),"undefined"!=typeof b.bindings[a]&&b.bindings[a][2].push(c),b},b.forget=function(a){return a=a.toLowerCase(),delete b.bindings[a],b};let H=()=>{};b.create=function(a,c,d){return a=a.toLowerCase(),c=c||H,d=d||H,z[a]=!1,b.bindings[a]=[c,d,[]],b},b.createView=function(a,c,d){return a=a.toLowerCase(),c=c.toLowerCase(),"undefined"==typeof b.bindings[a]&&r(" "),b.create(c,()=>d(b.get(a))),b.bind(a,c),b},b.update=function(a){if(a=a.toLowerCase(),"undefined"!=typeof b.bindings[a]){if(z[a])return b;z[a]=!0,b.bindings[a][2].forEach((c)=>{"string"==typeof c?b.update(c):"function"==typeof c?c(b.get(a)):c[0][c[1]]=b.bindings[a][0]()}),z[a]=!1}return b},b.dget=function(a){if(a=a.toLowerCase(),"undefined"!=typeof b.bindings[a])return b.get(a).arr},b.get=function(a){if(a=a.toLowerCase(),"undefined"!=typeof b.bindings[a])return b.bindings[a][0]()},b.set=function(a,c){if(a=a.toLowerCase(),"undefined"!=typeof b.bindings[a]){if(z[a])return;b.bindings[a][1]&&(b.bindings[a][1](c),b.update(a))}return b},Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),b.closest=function(a,c,d){d="undefined"==typeof d?"["+B+"]":d;let e=null;for(;a;){if(a.matches(d)&&("undefined"==typeof c||""===c||"undefined"!=typeof b.bindings[a.getAttribute(B).toLowerCase()+":"+c.toLowerCase()])){e=a;break}a=a.parentElement}return e},b.from=function(a){function d(){let b=0,c=0;for(let d=0;d<a.length;d++)a[d].length>b&&(b=a[d].length,c=d);return[c,b]}if("string"==typeof a){let c=a.substring(1),d=a[0];if("#"==d)return b.from(document.getElementById(a));if("*"==d)return b.from(document.querySelectorAll(c));if("$"==d)return b.from(document.querySelector(c));if("&"==d)return b.from(b.search(c));if("@"==d)return b.from(b.search(c).map(b.get))}let e={};if(a instanceof HTMLElement){function d(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function f(a,b,c){return c.indexOf(a)===b}function g(d){return function(){let f;if(f=b.closest(a)){f=f.getAttribute(B);let b=c(arguments);return b[0]=f+":"+b[0],d.apply(null,b)}return d.apply(null,arguments),e}}return e=a instanceof HTMLInputElement?m(a):o(a),e.var=g(b.var),e.const=g(b.const),e.dvar=g(b.dvar),e.bind=g(b.bind),e.watch=function(c){let e=c,g=!1,h=!1;("html"==c||"text"==c)&&(c="innerHTML",h=g=!0),"*"==c.charAt(0)&&(c=c.substring(1),h=g=!0),"innerHTML"===c&&(a instanceof HTMLStyleElement||a instanceof HTMLScriptElement)&&(g=!1);let i=h?a[c]:a.getAttribute(c)||"";let m=(i.toString().match(/\{\{[A-Za-z0-9\-_#]+(\|[^}]+(\}[^}]+)?)*\}\}/g)||[]).map((a)=>{let b=a.substring(2,a.length-2).split("|"),c=b[0];return b[0]="",[c.toLowerCase(),b.join("|").substring(1),d(a)]});m=m.filter((b)=>k(a,b[0])).filter(f);let j=m.map((a)=>new RegExp(a[2],"g")),o=()=>{let d=i.toString();g?b.from(a.childNodes).for((c)=>{c instanceof HTMLElement?(b.from(c).watch(e),b.from(c.attributes).for((a)=>{j.some((b)=>a.value.match(b))&&b.from(c).watch(a.name)})):c instanceof Text&&(d=c.data,""!==d.trim()&&(j.forEach((c,f)=>{let g=k(a,m[f][0]);""!==m[f][1]&&(g=l()+l(),b.createView(m[f][0],g,new Function(m[f][0],"return "+n(m[f][1]))));let h="*innerHTML"==e||"html"==e?"bind-to=\"innerHTML\"":"";d=d.replace(c,"<v bind=\""+g+"\""+h+"></v>")}),c.parentNode.replaceChild(new DOMParser().parseFromString("<v>"+d+"</v>","text/html").childNodes[0].childNodes[1].childNodes[0],c)))}):(j.forEach((c,e)=>{if(""!==m[e][1]){let f=new Function(m[e][0],"return "+m[e][1]);d=d.replace(c,f(b(a).get(m[e][0])))}else d=d.replace(c,b(a).get(m[e][0]))}),h?a[c]=d:a.setAttribute(c,d))};m.forEach((c)=>{g||b.bind(k(a,c[0]),o)}),o()},e.get=function(c){return b.get(k(a,c))},e.set=function(c,d){return b.set(k(a,c),d),e},e}return Array.isArray(a)?(e.do=(b)=>a.map(b),e.for=(b)=>a.forEach(b)):(e.for=(b)=>{for(let c=0;c<a.length;c++)b(a[c],c)},e.do=(b)=>{let c=[];for(let d=0;d<a.length;d++)c.push(b(a[d],d));return c}),e.filter=(b)=>{e._arrayFix();for(let c=0;c<a.length;c++)b(a[c])||a.splice(c,1);return e},e.release=()=>a,e.toArray=()=>a=c(a),e._arrayFix=()=>!Array.isArray(a)&&e.toArray(),e.transform=(b)=>{e._arrayFix();for(let c=0;c<a.length;c++)a[c]=b(a[c],c);return e},e.transpose=()=>{let b=d()[0];return((b,c)=>a[c].map((b,c)=>a.map((a)=>a[c])))(a,b)},e.sum=()=>(e._arrayFix(),a.concat([0]).reduce((a,b)=>parseFloat(b)+parseFloat(a)||0)),e.ffor=(b,c)=>{for(let d=0;d<a.length;d++)c(a[d])&&b(a[d],d)},e.table=function(b){function c(a,b){return"<"+b+">"+a+"</"+b+">"}b||(b={}),"undefined"==typeof b.fill&&(b.fill=""),"undefined"==typeof b.head&&(b.head=[]);let e=d()[1];for(let c=0;c<a.length;c++)for(;a[c].length<e;)a[c].push("");let f=c(a.map((a)=>c(a.map((a)=>c(a||b.fill,"td")).join(""),"tr")).join(""),"tbody"),g="";return b.head.length&&(g=c(c(b.head.map((a)=>c(a,"th")).join(""),"tr"),"thead")),c(g+f,"table")},e.fdo=(b,c)=>{let d=[];for(let e,f=0;f<a.length;f++)e=c(a[f])?b(a[f],f):null,void 0!==e&&null!==e&&d.push(e);return d},e},b.templates={getInt:(a)=>parseInt(a.val)||0,getPosInt:(a)=>{let b=parseInt(a.val);return 0>b?-b:b||0},getFloat:(a)=>parseFloat(a.val)||0,getAny:(a)=>"undefined"==typeof a.val?"":a.val,setInt:(a,b)=>a.val=parseInt(b),setFloat:(a,b)=>a.val=parseFloat(b),setAny:(a,b)=>a.val=b},b._CV=function(a,c,d){let e={val:"undefined"==typeof a?"":a},f=c?c:b.templates.getAny,g=d?d:b.templates.setAny;return e.set=(a)=>g(e,a),e.get=()=>f(e),e},b.dvar=function(a){a=a.toLowerCase();let c={arr:[]},d=(a,b,c)=>a.arr[c]=b,e=(a,b)=>a.arr[b];return c.set=(a,b)=>d(c,a,b),c.get=(a)=>e(c,a),c.count=()=>c.arr.length,b.create(a,()=>c),b.bindings[a].push("Array"),b},b.search=function(a){return Object.keys(b.bindings).filter((b)=>b.match(a))},b.const=function(a,c){return b.create(a,()=>c)},b.pvar=function(a,c){const d="bb_"+a;localStorage[d]||(localStorage[d]=c);return b.create(a,()=>localStorage[d],(a)=>{localStorage[d]=a}),b},b.var=function(c,d,e,f){let g=new b._CV(d,e,f);return b.create(c,g.get,g.set),b},b.range=function(a,b){return c(Array(b-a+1).keys()).map((b)=>b+a)},b.all=function(a){a=u(a),q(a),s(a),t(a),r(a),w(a),x(a),y(a),v(a)}}createBasylBinder($$),addEventListener("load",()=>$$.all());

/*! 
 * BasylBinder
 * 
 * Copyright 2018, Jesse Daniel Mitchell
 * Released under the MIT license.
 *
 * Date: 2018-04-22T22:35:32.502Z
 */
if("undefined"==typeof window.$$)$$=function(a){if(a instanceof Event||a instanceof HTMLElement||"object"==typeof a)return $$.from(a)};else{var z=window.$$;$$=function(a,b){return a instanceof Event||a instanceof HTMLElement||"object"==typeof a?$$.from(a):z(a,b)}}function createBasylBinder(b){function c(a){let b=[];for(let c=0;c<a.length;c++)b.push(a[c]);return b}function a(a){a=a.trim();let b=document.createElement("template");return b.content?(b.innerHTML=a,b.content.firstChild):(b=document.createElement("div"),b.innerHTML=a,b.childNodes[0])}function d(a,c){a.value=c(a.value);let d=a.onchange||I;return a.onchange=(b)=>{b.target.value=c(b.target.value),d(b),a.oninput&&a.oninput(b)},b}function e(a,c,d,e){e||(w[a][2].push([c,d]),c[d]=w[a][0]()),h(a,c,d,()=>b.get(a),(c)=>b.set(a,c))}function f(a,b,c,d,e,f){return"undefined"==typeof w[b]?void delete c.oninput:void(e()!=a.target[d]&&(A=a.target,f(a.target[d]),A=null))}function g(a,b,c,d,e,f){return"undefined"==typeof w[b]?void delete c.oninput:void(e()!=a.target[d]&&(A=a.target,c.hasAttribute("on-true")&&!0==a.target[d]?f(c.getAttribute("on-true")):c.hasAttribute("on-false")&&!1==a.target[d]?f(c.getAttribute("on-false")):f(a.target[d]),A=null))}function h(a,b,c,d,h){(b instanceof HTMLInputElement||b instanceof HTMLTextAreaElement||b.hasAttribute("contenteditable")||b instanceof HTMLSelectElement)&&(b.attributes.type&&("checkbox"===b.getAttribute("type")||"file"===b.getAttribute("type"))||b instanceof HTMLSelectElement?b.onchange=(f)=>g(f,a,b,c,d,h):b.oninput=(g)=>f(g,a,b,c,d,h))}function i(a,c,d,f){return f="undefined"!=typeof f&&f,a=k(c,a),"undefined"!=typeof w[a]&&"undefined"!=typeof c&&e(a,c,d,f),b}function k(a,c){c=c.toLowerCase();let d;return(d=b.closest(a,c))?d.getAttribute(B).toLowerCase()+":"+c:"undefined"==typeof w[c]?null:c}function l(){return Math.random().toString(36).substring(2)}function m(a){let b=new DOMParser().parseFromString(a,"text/html");return b.documentElement.textContent}function j(a){b.from("*"+a+"["+B+"]").for((a)=>{""===a.getAttribute(B)&&a.setAttribute(B,l())})}function n(a){b.from("*"+a+E).for((c)=>{let d=document.createElement("style");d.innerHTML=c.innerHTML,c.parentNode.replaceChild(d,c),b.from(d).watch("html")})}function o(a){function c(c,d){b.from("*"+a+c).for((a)=>{b.from(a.attributes).for((b)=>d(a)(b.name,b.value)),a.parentNode.removeChild(a)})}j(a);let d=(a)=>(c)=>b.from(c)[a];return c(C,d("var")),c(H,d("jvar")),c(G,d("const")),c(F,()=>b.pvar),b}function p(a){b.from("*"+a+"component[make]").for((a)=>{x[a.getAttribute("type")]=[a.innerHTML],a.parentNode.removeChild(a)})}function q(a){b.from("*"+a+"component[from]").for((a)=>{let c=a.getAttribute("type");a.setAttribute("was-from",!0),a.removeAttribute("from"),a.setAttribute("watch","html"),a.getAttribute("local-bind")||a.setAttribute("local-bind","");let d=a.querySelectorAll(C+","+G+","+H);a.innerHTML=x[c][0],b.from(d).for((b)=>a.appendChild(b))})}function r(a){return"undefined"==typeof a?"":a+" "}function s(a){b.from("*"+a+"[basyl-if]:not(basyl-if-watched)").for((a)=>{let c,d=a.getAttribute("basyl-if"),e=(a)=>a;-1!=(c=d.indexOf("|"))&&(e=new Function(d.substring(0,c),"return "+d.substring(c+1)),d=d.substring(0,c));let f=a.style.display;d=k(a,d),b.bind(d,()=>{a.style.display=e(b.get(d))?f:"none"}),a.style.display=e(b.get(d))?f:"none",a.setAttribute("basyl-if-watched",d),a.removeAttribute("basyl-if")})}function t(a){b.from("*"+a+D).for((a)=>{new Function("me",a.textContent)(b.from(a)),a.innerHTML=""})}function u(a){b.from("*"+a+"[watch]:not([watched])").for((a)=>{let c=a.getAttribute("watch").split(" ");b.from(c).for((c)=>{b.from(a).watch(c)}),a.setAttribute("watched",a.getAttribute("watch").toLowerCase()),a.removeAttribute("watch")})}function v(a,c){c="undefined"==typeof c?0:c,b.from("*"+a+"[bind]:not([bound])").for((b)=>{let d=k(b,b.getAttribute("bind"));if("undefined"==typeof w[d])return c++,void(4>c&&setTimeout(()=>v(a,c),200*c));let e,f="undefined"!=typeof b.attributes["one-way"];e="undefined"==typeof b.attributes["bind-to"]?b instanceof HTMLInputElement?"object"==typeof b.attributes.type&&"checkbox"===b.getAttribute("type")?"checked":"value":b instanceof HTMLTextAreaElement||b instanceof HTMLSelectElement?"value":"textContent":b.getAttribute("bind-to"),b.setAttribute("bound",d),b.removeAttribute("bind"),i(d,b,e,f)})}let w={},x={},y={},z={},A=null;const B="local-bind",C="vars",D="script[type=\"basyl-script\"]",E="script[type=\"basyl-style\"]",F="pvars",G="svars",H="jvars";b.components=()=>x,b.queue=function(a,c){return"undefined"!=typeof z[a]&&clearTimeout(z[a]),z[a]=setTimeout(()=>{b.update(a),delete z[a]},c),b},b.delay=function(a,c,d){return b.bind(a,()=>b.queue(c,d)),b},b.now=function(){return Object.keys(z).forEach((a)=>{clearTimeout(z[a]),b.update(a),delete z[a]}),b},b.make=function(c,d){const e="basyl-now";return{appendTo:(f)=>{let g=a(`<component local-bind="${l()}" type="${c}" from></component>`);f.appendChild(g);let h=b.from(g);return d&&Object.keys(d).forEach((a)=>{h.var(a,d[a])}),f.setAttribute(e,""),b.all("["+e+"]"),f.removeAttribute(e),h}}},b.bind=function(a,c){return o(" "),a=a.toLowerCase(),"string"==typeof c&&(c=c.toLowerCase()),"undefined"!=typeof w[a]&&w[a][2].push(c),b},b.forget=function(a){return a=a.toLowerCase(),delete w[a],b};let I=()=>{};b.create=function(a,c,d){return a=a.toLowerCase(),c=c||I,d=d||I,y[a]=!1,w[a]=[c,d,[]],b},b.createView=function(a,c,d){return a=a.toLowerCase(),c=c.toLowerCase(),"undefined"==typeof w[a]&&o(" "),b.create(c,()=>d(b.get(a))),b.bind(a,c),b},b.update=function(a){if(a=a.toLowerCase(),"undefined"!=typeof w[a]){if(y[a])return b;y[a]=!0,w[a][2].forEach((c)=>{"string"==typeof c?b.update(c):"function"==typeof c?c(b.get(a)):A==c[0]?c[0].onblur=()=>{c[0][c[1]]=w[a][0](),delete c[0].onblur}:c[0][c[1]]=w[a][0]()}),y[a]=!1}return b},b.get=function(a){if(a=a.toLowerCase(),"undefined"!=typeof w[a])return w[a][0]()},b.set=function(a,c){if(a=a.toLowerCase(),"undefined"!=typeof w[a]){if(y[a])return;w[a][1]&&(w[a][1](c),b.update(a))}return b},Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),b.closest=function(a,b,c){c="undefined"==typeof c?"["+B+"]":c;let d=null;for(;a;){if(a.matches(c)&&("undefined"==typeof b||""===b||"undefined"!=typeof w[a.getAttribute(B).toLowerCase()+":"+b.toLowerCase()])){d=a;break}a=a.parentElement}return d},b.from=function(e){function a(){let a=0,b=0;for(let c=0;c<e.length;c++)e[c].length>a&&(a=e[c].length,b=c);return[b,a]}if("string"==typeof e){let a=e.substring(1),c=e[0];if("#"==c)return b.from(document.getElementById(a));if("*"==c)return b.from(document.querySelectorAll(a));if("$"==c)return b.from(document.querySelector(a));if("&"==c)return b.from(b.search(a));if("@"==c)return b.from(b.search(a).map(b.get))}let f={};if(f.release=()=>e,e instanceof Event&&(e=e.target),e instanceof HTMLElement){function a(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(a,b,c){return c.indexOf(a)===b}function h(d,g){return function(){let h;if(h=b.closest(e)){h=h.getAttribute(B);let b=c(arguments);return g.forEach((a)=>{"string"==typeof b[a]&&("string"==typeof a?b[a]=k(e,b[0|a]):b[a]=h+":"+b[a])}),d.apply(null,b),f}return d.apply(null,arguments),f}}return e instanceof HTMLInputElement?(f.bind=function(a,b){return i(a,e,"value",b),f},f.format=function(a){return d(e,a),f}):f.bind=function(a,b,c){return i(a,e,b,c),f},f.create=h(b.create,[0]),f.var=h(b.var,[0]),f.jvar=h(b.jvar,[0]),f.const=h(b.const,[0]),f.createView=h(b.createView,["0",1]),f.bind=h(b.bind,["0","1"]),f.delay=h(b.delay,["0","1"]),f.watch=function(c){let d=c,h=!1,i=!1;("html"==c||"text"==c)&&(c="innerHTML",i=h=!0),"*"==c.charAt(0)&&(c=c.substring(1),i=h=!0),"innerHTML"===c&&(e instanceof HTMLStyleElement||e instanceof HTMLScriptElement)&&(h=!1);let j=i?e[c]:e.getAttribute(c)||"";let n=(j.toString().match(/\{\{[A-Za-z0-9\-_#]+(\|[^}]+(\}[^}]+)?)*\}\}/g)||[]).map((b)=>{let c=b.substring(2,b.length-2).split("|"),d=c[0];return c[0]="",[d.toLowerCase(),c.join("|").substring(1),a(b)]});n=n.filter((a)=>k(e,a[0])).filter(g);let o=n.map((a)=>new RegExp(a[2],"g")),p=()=>{let a=j.toString();h?b.from(e.childNodes).for((c)=>{c instanceof HTMLElement?(b.from(c).watch(d),b.from(c.attributes).for((a)=>{o.some((b)=>a.value.match(b))&&b.from(c).watch(a.name)})):c instanceof Text&&(a=c.data,""!==a.trim()&&(o.forEach((c,f)=>{let g=k(e,n[f][0]);""!==n[f][1]&&(g=l()+l(),b.createView(n[f][0],g,new Function(n[f][0],"return "+m(n[f][1]))));let h="*innerHTML"==d||"html"==d?"bind-to=\"innerHTML\"":"";a=a.replace(c,"<v bind=\""+g+"\""+h+"></v>")}),c.parentNode.replaceChild(new DOMParser().parseFromString("<v>"+a+"</v>","text/html").childNodes[0].childNodes[1].childNodes[0],c)))}):(o.forEach((c,d)=>{if(""!==n[d][1]){let f=new Function(n[d][0],"return "+n[d][1]);a=a.replace(c,f(b(e).get(n[d][0])))}else a=a.replace(c,b(e).get(n[d][0]))}),i?e[c]=a:e.setAttribute(c,a))};n.forEach((a)=>{h||f.bind(a[0],p)}),p()},f.get=function(a){return b.get(k(e,a))},f.update=function(a){return b.update(k(e,a)),f},f.search=function(a){return b.search(a,e)},f.from=function(a){let c=a.substring(1),d=a[0];return"*"==d?b.from(e.querySelectorAll(c)):"$"==d?b.from(e.querySelector(c)):"&"==d?b.from(b.search(c,e)):"@"==d?b.from(b.search(c,e).map(b.get)):void 0},f.set=function(a,c){return b.set(k(e,a),c),f},f}return Array.isArray(e)?(f.do=(a)=>e.map(a),f.for=(a)=>e.forEach(a)):(f.for=(a)=>{for(let b=0;b<e.length;b++)a(e[b],b)},f.do=(a)=>{let b=[];for(let c=0;c<e.length;c++)b.push(a(e[c],c));return b}),f.filter=(a)=>{f._arrayFix();for(let b=0;b<e.length;b++)a(e[b])||(e.splice(b,1),b--);return f},f.toArray=()=>e=c(e),f._arrayFix=()=>!Array.isArray(e)&&f.toArray(),f.transform=(a)=>{f._arrayFix();for(let b=0;b<e.length;b++)e[b]=a(e[b],b);return f},f.transpose=()=>{let b=a()[0];return((a,b)=>e[b].map((a,b)=>e.map((a)=>a[b])))(e,b)},f.sum=()=>(f._arrayFix(),e.concat([0]).reduce((a,b)=>parseFloat(b)+parseFloat(a)||0)),f.ffor=(a,b)=>{for(let c=0;c<e.length;c++)b(e[c])&&a(e[c],c)},f.table=function(b){function c(a,b){return"<"+b+">"+a+"</"+b+">"}b||(b={}),"undefined"==typeof b.fill&&(b.fill=""),"undefined"==typeof b.head&&(b.head=[]);let d=a()[1];for(let a=0;a<e.length;a++)for(;e[a].length<d;)e[a].push("");let f=c(e.map((a)=>c(a.map((a)=>c(a||b.fill,"td")).join(""),"tr")).join(""),"tbody"),g="";return b.head.length&&(g=c(c(b.head.map((a)=>c(a,"th")).join(""),"tr"),"thead")),c(g+f,"table")},f.fdo=(a,b)=>{let c=[];for(let d,f=0;f<e.length;f++)d=b(e[f])?a(e[f],f):null,void 0!==d&&null!==d&&c.push(d);return c},f},b.templates={getInt:(a)=>parseInt(a.val)||0,getPosInt:(a)=>{let b=parseInt(a.val);return 0>b?-b:b||0},getFloat:(a)=>parseFloat(a.val)||0,getAny:(a)=>"undefined"==typeof a.val?"":a.val,setInt:(a,b)=>a.val=parseInt(b),setFloat:(a,b)=>a.val=parseFloat(b),setAny:(a,b)=>a.val=b},b._CV=function(a,c,d){let e={val:"undefined"==typeof a?"":a},f=c?c:b.templates.getAny,g=d?d:b.templates.setAny;return e.set=(a)=>g(e,a),e.get=()=>f(e),e},b.search=function(a,c){a=(a||"").toLowerCase();let d=(a)=>Object.keys(w).filter((b)=>b.match(a));if(c)if("string"==typeof c)return b.search(a,document.querySelector(r(c)));else{let e=b.closest(c);if(e){let c=[];return b.from(e.querySelectorAll("["+B+"]")).for((b)=>{c.push.apply(c,d(b.getAttribute(B)+":"+a)||[])}),c.push.apply(c,d(e.getAttribute(B)+":"+a)||[]),c}}return d(a)},b.const=function(a,c){return b.create(a,()=>c)},b.pvar=function(a,c){if(w[a])return;const d="bb_"+a;localStorage[d]||(localStorage[d]=c);return b.create(a,()=>localStorage[d],(a)=>{localStorage[d]=a}),b},b.var=function(c,d,e,f){let g=new b._CV(d,e,f);return b.create(c,g.get,g.set),b},b.jvar=function(a,c){return b.var(a,JSON.parse(c))},b.range=function(a,b){return c(Array(b-a+1).keys()).map((b)=>b+a)},b.all=function(a){a=r(a),p(a),q(a),o(a),n(a),t(a),u(a),v(a),s(a)}}createBasylBinder($$),addEventListener("load",()=>$$.all());
